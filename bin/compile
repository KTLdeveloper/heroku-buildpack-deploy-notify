#!/usr/bin/env bash

# Message to send
MESSAGE="Heroku app '${HEROKU_APP_NAME}' has been successfully released! Env: ${ENVIRONMENT_NAME] Commit: ${HEROKU_SLUG_COMMIT}, Release: ${HEROKU_RELEASE_VERSION} at ${HEROKU_RELEASE_CREATED_AT}"
echo $MESSAGE

# Send the message
curl -X POST\
  -H 'Content-type: application/json'\
   --data "{\"blocks\": [{\"type\": \"context\",\"elements\": [{\"type\": \"context\",\"elements\": [{\"type\": \"mrkdwn\",\"text\": \"*${HEROKU_APP_NAME}* has been successfully deployed!\"}]},{\"type\": \"context\",\"elements\": [{\"type\": \"mrkdwn\",\"text\": \"*Commit Hash:* ${HEROKU_SLUG_COMMIT}\"}]},{\"type\": \"context\",\"elements\": [{\"type\": \"mrkdwn\",\"text\": \"*Release Version:* ${HEROKU_RELEASE_VERSION}\"}]},{\"type\": \"context\",\"elements\": [{\"type\": \"mrkdwn\",\"text\": \"*Release At:* ${HEROKU_RELEASE_CREATED_AT}\"}]}]}"\
   ${SLACK_WEBHOOK_URL}

echo "Slack notification sent."
